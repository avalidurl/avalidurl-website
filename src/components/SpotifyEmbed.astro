---
export interface Props {
  uri: string; // Spotify URI (track, album, playlist)
  width?: number;
  height?: number;
  theme?: 'light' | 'dark';
}

const { uri, width = 352, height = 152, theme = 'light' } = Astro.props;

// Convert Spotify URI to embed URL
let embedUrl = '';
if (uri.includes('spotify.com')) {
  // Handle full Spotify URLs
  const match = uri.match(/spotify\.com\/(track|album|playlist|artist)\/([a-zA-Z0-9]+)/);
  if (match) {
    embedUrl = `https://open.spotify.com/embed/${match[1]}/${match[2]}?utm_source=generator&theme=${theme}`;
  }
} else if (uri.startsWith('spotify:')) {
  // Handle Spotify URIs
  embedUrl = `https://open.spotify.com/embed/${uri.replace('spotify:', '').replace(/:/g, '/')}?utm_source=generator&theme=${theme}`;
}
---

{embedUrl && (
  <iframe 
    src={embedUrl}
    width={width}
    height={height}
    frameborder="0" 
    allowfullscreen=""
    allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture"
    loading="lazy"
    style="border-radius: 12px; margin: 1rem 0;"
  ></iframe>
)}